---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "elasticstack_elasticsearch_snapshot_lifecycle Resource - terraform-provider-elasticstack"
subcategory: ""
description: |-
  Creates or updates a snapshot lifecycle policy. See, https://www.elastic.co/guide/en/elasticsearch/reference/current/slm-api-put-policy.html
---

# elasticstack_elasticsearch_snapshot_lifecycle (Resource)

Creates or updates a snapshot lifecycle policy. See, https://www.elastic.co/guide/en/elasticsearch/reference/current/slm-api-put-policy.html

## Example Usage

```terraform
provider "elasticstack" {
  elasticsearch {}
}

// create a repository for snapshots
resource "elasticstack_elasticsearch_snapshot_repository" "repo" {
  name = "my_snap_repo"

  fs {
    location                  = "/tmp/snapshots"
    compress                  = true
    max_restore_bytes_per_sec = "20mb"
  }
}

// create a SLM policy and use the above created repository
resource "elasticstack_elasticsearch_snapshot_lifecycle" "slm_policy" {
  name = "my_slm_policy"

  schedule      = "0 30 1 * * ?"
  snapshot_name = "<daily-snap-{now/d}>"
  repository    = elasticstack_elasticsearch_snapshot_repository.repo.name

  config {
    indices              = ["data-*", "important"]
    ignore_unavailable   = false
    include_global_state = false
  }

  expire_after = "30d"
  min_count    = 5
  max_count    = 50
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **config** (Block List, Min: 1, Max: 1) Configuration for each snapshot created by the policy. (see [below for nested schema](#nestedblock--config))
- **name** (String) ID for the snapshot lifecycle policy you want to create or update.
- **repository** (String) Repository used to store snapshots created by this policy.
- **schedule** (String) Periodic or absolute schedule at which the policy creates snapshots.

### Optional

- **elasticsearch_connection** (Block List, Max: 1) Used to establish connection to Elasticsearch server. Overrides environment variables if present. (see [below for nested schema](#nestedblock--elasticsearch_connection))
- **expire_after** (String) Time period after which a snapshot is considered expired and eligible for deletion.
- **id** (String) The ID of this resource.
- **max_count** (Number) Maximum number of snapshots to retain, even if the snapshots have not yet expired.
- **min_count** (Number) Minimum number of snapshots to retain, even if the snapshots have expired.
- **snapshot_name** (String) Name automatically assigned to each snapshot created by the policy.

<a id="nestedblock--config"></a>
### Nested Schema for `config`

Optional:

- **expand_wildcards** (String) Determines how wildcard patterns in the `indices` parameter match data streams and indices. Supports comma-separated values, such as `closed,hidden`.
- **feature_states** (Set of String) Feature states to include in the snapshot.
- **ignore_unavailable** (Boolean) If `false`, the snapshot fails if any data stream or index in indices is missing or closed. If `true`, the snapshot ignores missing or closed data streams and indices.
- **include_global_state** (Boolean) If `true`, include the cluster state in the snapshot.
- **indices** (Set of String) Comma-separated list of data streams and indices to include in the snapshot.
- **metadata** (String) Attaches arbitrary metadata to the snapshot.
- **partial** (Boolean) If `false`, the entire snapshot will fail if one or more indices included in the snapshot do not have all primary shards available.


<a id="nestedblock--elasticsearch_connection"></a>
### Nested Schema for `elasticsearch_connection`

Optional:

- **endpoints** (List of String, Sensitive) A list of endpoints the Terraform provider will point to. They must include the http(s) schema and port number.
- **password** (String, Sensitive) A password to use for API authentication to Elasticsearch.
- **username** (String) A username to use for API authentication to Elasticsearch.


